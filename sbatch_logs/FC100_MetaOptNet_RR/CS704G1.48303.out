Requirement already satisfied: cvxpy in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from -r requirements.txt (line 1)) (1.1.24)
Requirement already satisfied: enum34 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from -r requirements.txt (line 2)) (1.1.10)
Requirement already satisfied: h5py in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from -r requirements.txt (line 3)) (3.1.0)
Requirement already satisfied: numpy in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from -r requirements.txt (line 4)) (1.19.5)
Requirement already satisfied: torch>=1.8.0 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from -r requirements.txt (line 5)) (1.10.2)
Requirement already satisfied: torchvision>=0.9.0 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from -r requirements.txt (line 6)) (0.11.3)
Collecting qpth==0.0.16
  Downloading qpth-0.0.16.tar.gz (16 kB)
Requirement already satisfied: torchnet in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from -r requirements.txt (line 8)) (0.0.4)
Requirement already satisfied: tqdm in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from -r requirements.txt (line 9)) (4.64.1)
Requirement already satisfied: scipy>=1.1.0 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from cvxpy->-r requirements.txt (line 1)) (1.5.4)
Requirement already satisfied: scs>=1.1.6 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from cvxpy->-r requirements.txt (line 1)) (3.2.2)
Requirement already satisfied: ecos>=2 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from cvxpy->-r requirements.txt (line 1)) (2.0.10)
Requirement already satisfied: osqp>=0.4.1 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from cvxpy->-r requirements.txt (line 1)) (0.6.5)
Requirement already satisfied: cached-property in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from h5py->-r requirements.txt (line 3)) (1.5.2)
Requirement already satisfied: typing_extensions in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from torch>=1.8.0->-r requirements.txt (line 5)) (4.1.1)
Requirement already satisfied: dataclasses in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from torch>=1.8.0->-r requirements.txt (line 5)) (0.8)
Requirement already satisfied: pillow!=8.3.0,>=5.3.0 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from torchvision>=0.9.0->-r requirements.txt (line 6)) (8.4.0)
Requirement already satisfied: visdom in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from torchnet->-r requirements.txt (line 8)) (0.2.4)
Requirement already satisfied: six in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from torchnet->-r requirements.txt (line 8)) (1.16.0)
Requirement already satisfied: importlib-resources in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from tqdm->-r requirements.txt (line 9)) (5.4.0)
Requirement already satisfied: qdldl in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from osqp>=0.4.1->cvxpy->-r requirements.txt (line 1)) (0.1.7.post0)
Requirement already satisfied: zipp>=3.1.0 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from importlib-resources->tqdm->-r requirements.txt (line 9)) (3.6.0)
Requirement already satisfied: requests in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from visdom->torchnet->-r requirements.txt (line 8)) (2.27.1)
Requirement already satisfied: websocket-client in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from visdom->torchnet->-r requirements.txt (line 8)) (1.3.1)
Requirement already satisfied: tornado in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from visdom->torchnet->-r requirements.txt (line 8)) (6.1)
Requirement already satisfied: jsonpatch in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from visdom->torchnet->-r requirements.txt (line 8)) (1.32)
Requirement already satisfied: networkx in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from visdom->torchnet->-r requirements.txt (line 8)) (2.5.1)
Requirement already satisfied: jsonpointer>=1.9 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from jsonpatch->visdom->torchnet->-r requirements.txt (line 8)) (2.3)
Requirement already satisfied: decorator<5,>=4.3 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from networkx->visdom->torchnet->-r requirements.txt (line 8)) (4.4.2)
Requirement already satisfied: certifi>=2017.4.17 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from requests->visdom->torchnet->-r requirements.txt (line 8)) (2021.5.30)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from requests->visdom->torchnet->-r requirements.txt (line 8)) (1.26.18)
Requirement already satisfied: charset-normalizer~=2.0.0 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from requests->visdom->torchnet->-r requirements.txt (line 8)) (2.0.12)
Requirement already satisfied: idna<4,>=2.5 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from requests->visdom->torchnet->-r requirements.txt (line 8)) (3.6)
Building wheels for collected packages: qpth
  Building wheel for qpth (setup.py): started
  Building wheel for qpth (setup.py): finished with status 'done'
  Created wheel for qpth: filename=qpth-0.0.16-py3-none-any.whl size=19536 sha256=4567796501082c6a3feafde447b253e68a7794d07564f59e75ab8abc7d7006e9
  Stored in directory: /common/home/projectgrps/CS704/CS704G1/tmp/pip-ephem-wheel-cache-git7myne/wheels/7c/64/bd/a5ce0ee69fdc7edff9e7ea3ea037168abde83d4d62a92bc877
Successfully built qpth
Installing collected packages: qpth
  Attempting uninstall: qpth
    Found existing installation: qpth 0.0.13
    Uninstalling qpth-0.0.13:
      Successfully uninstalled qpth-0.0.13
Successfully installed qpth-0.0.16
You are allocated NVIDIA GeForce RTX 3090 on lava
You are using GPU 3
Loading FC100 dataset - phase train
Loading FC100 dataset - phase val
using gpu: 0, 1, 2, 3
{'num_epoch': 60, 'save_epoch': 10, 'train_shot': 15, 'val_shot': 5, 'train_query': 6, 'val_episode': 2000, 'val_query': 15, 'train_way': 5, 'test_way': 5, 'save_path': './experiments/FC100_MetaOptNet_RR', 'gpu': '0, 1, 2, 3', 'network': 'ResNet', 'head': 'Ridge', 'dataset': 'FC100', 'episodes_per_batch': 8, 'eps': 0.0}
Train Epoch: 1	Learning Rate: 0.1000
/common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages/torch/optim/lr_scheduler.py:134: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:03<?, ?it/s]
Traceback (most recent call last):
  File "train.py", line 208, in <module>
    logit_query = cls_head.forward(cls_head.head, cls_head.scale, cls_head.enable_scale, emb_query, emb_support, labels_support, opt.train_way, opt.train_shot)
  File "/common/home/projectgrps/CS704/CS704G1/MetaOptNet/models/classification_heads.py", line 555, in forward
    return scale * head(query, support, support_labels, n_way, n_shot, **kwargs)
  File "/common/home/projectgrps/CS704/CS704G1/MetaOptNet/models/classification_heads.py", line 127, in MetaOptNetHead_Ridge
    qp_sol = qp_function_instance.apply(G, e.detach(), C.detach(), h.detach(), dummy.detach(), dummy.detach())
AttributeError: 'builtin_function_or_method' object has no attribute 'apply'
srun: error: lava: task 0: Exited with exit code 1
srun: Terminating StepId=48303.1
Job ID: 48303
Cluster: crimson
User/Group: CS704G1/CS704G1
State: FAILED (exit code 1)
Nodes: 1
Cores per node: 4
CPU Utilized: 00:00:21
CPU Efficiency: 37.50% of 00:00:56 core-walltime
Job Wall-clock time: 00:00:14
Memory Utilized: 3.39 MB
Memory Efficiency: 0.02% of 16.00 GB
