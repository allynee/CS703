Requirement already satisfied: cvxpy in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from -r requirements.txt (line 1)) (1.1.24)
Requirement already satisfied: enum34 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from -r requirements.txt (line 2)) (1.1.10)
Collecting h5py
  Downloading h5py-3.1.0-cp36-cp36m-manylinux1_x86_64.whl (4.0 MB)
Requirement already satisfied: numpy in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from -r requirements.txt (line 4)) (1.19.5)
Requirement already satisfied: torch==1.0.1.post2 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from -r requirements.txt (line 5)) (1.0.1.post2)
Requirement already satisfied: torchvision==0.2.2.post2 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from -r requirements.txt (line 6)) (0.2.2.post2)
Requirement already satisfied: qpth==0.0.13 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from -r requirements.txt (line 7)) (0.0.13)
Requirement already satisfied: torchnet in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from -r requirements.txt (line 8)) (0.0.4)
Requirement already satisfied: tqdm in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from -r requirements.txt (line 9)) (4.64.1)
Requirement already satisfied: six in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from torchvision==0.2.2.post2->-r requirements.txt (line 6)) (1.16.0)
Requirement already satisfied: pillow>=4.1.1 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from torchvision==0.2.2.post2->-r requirements.txt (line 6)) (8.4.0)
Requirement already satisfied: scs>=1.1.6 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from cvxpy->-r requirements.txt (line 1)) (3.2.2)
Requirement already satisfied: osqp>=0.4.1 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from cvxpy->-r requirements.txt (line 1)) (0.6.5)
Requirement already satisfied: ecos>=2 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from cvxpy->-r requirements.txt (line 1)) (2.0.10)
Requirement already satisfied: scipy>=1.1.0 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from cvxpy->-r requirements.txt (line 1)) (1.5.4)
Collecting cached-property
  Downloading cached_property-1.5.2-py2.py3-none-any.whl (7.6 kB)
Requirement already satisfied: visdom in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from torchnet->-r requirements.txt (line 8)) (0.2.4)
Requirement already satisfied: importlib-resources in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from tqdm->-r requirements.txt (line 9)) (5.4.0)
Requirement already satisfied: qdldl in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from osqp>=0.4.1->cvxpy->-r requirements.txt (line 1)) (0.1.7.post0)
Requirement already satisfied: zipp>=3.1.0 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from importlib-resources->tqdm->-r requirements.txt (line 9)) (3.6.0)
Requirement already satisfied: requests in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from visdom->torchnet->-r requirements.txt (line 8)) (2.27.1)
Requirement already satisfied: jsonpatch in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from visdom->torchnet->-r requirements.txt (line 8)) (1.32)
Requirement already satisfied: networkx in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from visdom->torchnet->-r requirements.txt (line 8)) (2.5.1)
Requirement already satisfied: websocket-client in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from visdom->torchnet->-r requirements.txt (line 8)) (1.3.1)
Requirement already satisfied: tornado in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from visdom->torchnet->-r requirements.txt (line 8)) (6.1)
Requirement already satisfied: jsonpointer>=1.9 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from jsonpatch->visdom->torchnet->-r requirements.txt (line 8)) (2.3)
Requirement already satisfied: decorator<5,>=4.3 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from networkx->visdom->torchnet->-r requirements.txt (line 8)) (4.4.2)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from requests->visdom->torchnet->-r requirements.txt (line 8)) (1.26.18)
Requirement already satisfied: idna<4,>=2.5 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from requests->visdom->torchnet->-r requirements.txt (line 8)) (3.6)
Requirement already satisfied: charset-normalizer~=2.0.0 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from requests->visdom->torchnet->-r requirements.txt (line 8)) (2.0.12)
Requirement already satisfied: certifi>=2017.4.17 in /common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages (from requests->visdom->torchnet->-r requirements.txt (line 8)) (2021.5.30)
Installing collected packages: cached-property, h5py
Successfully installed cached-property-1.5.2 h5py-3.1.0
You are allocated NVIDIA GeForce RTX 3090 on lava
You are using GPU 0
Loading FC100 dataset - phase train
Loading FC100 dataset - phase val
using gpu: 0, 1, 2, 3
{'num_epoch': 60, 'save_epoch': 10, 'train_shot': 15, 'val_shot': 5, 'train_query': 6, 'val_episode': 2000, 'val_query': 15, 'train_way': 5, 'test_way': 5, 'save_path': './experiments/FC100_MetaOptNet_RR', 'gpu': '0, 1, 2, 3', 'network': 'ResNet', 'head': 'Ridge', 'dataset': 'FC100', 'episodes_per_batch': 8, 'eps': 0.0}
Train Epoch: 1	Learning Rate: 0.1000
  0%|          | 0/1000 [00:00<?, ?it/s]THCudaCheck FAIL file=/pytorch/aten/src/THC/THCGeneral.cpp line=405 error=8 : invalid device function
  0%|          | 0/1000 [00:01<?, ?it/s]
Traceback (most recent call last):
  File "train.py", line 201, in <module>
    emb_support = embedding_net(data_support.reshape([-1] + list(data_support.shape[-3:])))
  File "/common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages/torch/nn/modules/module.py", line 489, in __call__
    result = self.forward(*input, **kwargs)
  File "/common/home/projectgrps/CS704/CS704G1/MetaOptNet/models/ResNet12_embedding.py", line 111, in forward
    x = self.layer1(x)
  File "/common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages/torch/nn/modules/module.py", line 489, in __call__
    result = self.forward(*input, **kwargs)
  File "/common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages/torch/nn/modules/container.py", line 92, in forward
    input = module(input)
  File "/common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages/torch/nn/modules/module.py", line 489, in __call__
    result = self.forward(*input, **kwargs)
  File "/common/home/projectgrps/CS704/CS704G1/MetaOptNet/models/ResNet12_embedding.py", line 43, in forward
    out = self.bn1(out)
  File "/common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages/torch/nn/modules/module.py", line 489, in __call__
    result = self.forward(*input, **kwargs)
  File "/common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages/torch/nn/modules/batchnorm.py", line 76, in forward
    exponential_average_factor, self.eps)
  File "/common/home/projectgrps/CS704/CS704G1/.conda/envs/metalearning/lib/python3.6/site-packages/torch/nn/functional.py", line 1623, in batch_norm
    training, momentum, eps, torch.backends.cudnn.enabled
RuntimeError: cuDNN error: CUDNN_STATUS_EXECUTION_FAILED
srun: error: lava: task 0: Exited with exit code 1
srun: Terminating StepId=48272.1
Job ID: 48272
Cluster: crimson
User/Group: CS704G1/CS704G1
State: FAILED (exit code 1)
Nodes: 1
Cores per node: 4
CPU Utilized: 00:10:28
CPU Efficiency: 24.53% of 00:42:40 core-walltime
Job Wall-clock time: 00:10:40
Memory Utilized: 3.19 GB
Memory Efficiency: 19.92% of 16.00 GB
